C51 COMPILER V8.02   MAIN                                                                  01/29/2018 14:30:31 PAGE 1   


C51 COMPILER V8.02, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN ..\debug\main.obj
COMPILER INVOKED BY: C:\Keil\C51\BIN\C51.EXE ..\code\main.c LARGE BROWSE DEBUG OBJECTEXTEND PRINT(.\main.lst) TABS(2) OB
                    -JECT(..\debug\main.obj)

line level    source

   1          #include "uip.h" 
   2          #include "uip_arp.h"
   3          #include "enc28j60.h"
   4          
   5          #define BUF ((struct uip_eth_hdr *)&uip_buf[0])
   6          
   7          #ifndef NULL
              #define NULL (void *)0
              #endif
  10          
  11          main(void)
  12          {
  13   1        idata u8_t i, arptimer;
  14   1        idata u16_t j;
  15   1      
  16   1        /* Initialize the device driver. */ 
  17   1        dev_init();
  18   1        uip_arp_init();
  19   1      
  20   1        /* Initialize the uIP TCP/IP stack. */
  21   1        uip_init();
  22   1        
  23   1        arptimer = 0;
  24   1        while(1) 
  25   1        {
  26   2          uip_len = dev_poll();
  27   2          for(j=0;j<500;j++);
  28   2          if(uip_len == 0) 
  29   2          {
  30   3            for(i = 0; i < UIP_CONNS; i++) 
  31   3            {
  32   4              uip_periodic(i);
  33   4              if(uip_len > 0) 
  34   4              {
  35   5                uip_arp_out();
  36   5                dev_send();
  37   5              }
  38   4            }
  39   3      
  40   3      #if UIP_UDP
                    for(i = 0; i < UIP_UDP_CONNS; i++) 
                    {
                      uip_udp_periodic(i);
                      if(uip_len > 0) 
                      {
                        uip_arp_out();
                        dev_send();
                      }
                    }
              #endif /* UIP_UDP */
  51   3      
  52   3            /* Call the ARP timer function every 10 seconds. */
  53   3            if(++arptimer == 20) 
  54   3            { 
C51 COMPILER V8.02   MAIN                                                                  01/29/2018 14:30:31 PAGE 2   

  55   4              uip_arp_timer();
  56   4              arptimer = 0;
  57   4            }
  58   3          }else 
  59   2          {
  60   3            if(BUF->type == htons(UIP_ETHTYPE_IP)) 
  61   3            {
  62   4              uip_arp_ipin();
  63   4              uip_input();
  64   4              if(uip_len > 0) 
  65   4              {
  66   5                uip_arp_out();
  67   5                dev_send();
  68   5              }
  69   4            }
  70   3            else if(BUF->type == htons(UIP_ETHTYPE_ARP)) 
  71   3            {
  72   4              uip_arp_arpin();
  73   4              if(uip_len > 0) 
  74   4              { 
  75   5                dev_send();
  76   5              }
  77   4            }
  78   3          }
  79   2        }
  80   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    244    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----       4
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
